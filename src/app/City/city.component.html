<div class="card">
    <div class="card-body">
      <div>
        <h1>City List</h1>
      </div>
      <div class="mb-3" style="text-align: right">
        <button pButton pRipple icon="pi pi-plus-circle" label="Add New City" class="btn btn-primary"
          (click)="CreateCity(0)"></button>
      </div>
      <p-table responsive="true" #dt [globalFilterFields]="['name', 'code']" sortMode="multiple"
        [multiSortMeta]="[{ field: 'name', order: 1 }, { field: 'code', order: 1 },]"
        [value]="CityList" [paginator]="true"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [rows]="10"
        [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" styleClass="p-datatable-striped">
        <ng-template pTemplate="caption">
          <div class="d-flex flex-row flex-wrap justify-content-between align-items-center py-2">
            <span> List of City</span>
            <span class="p-input-icon-left">
              <i class="pi pi-search"></i>
              <input pInputText type="text" placeholder="Search"
                (input)="dt.filterGlobal($event.target.value, 'contains')" />
            </span>
          </div>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th pSortableColumn="name">Name
              <p-sortIcon field="name"></p-sortIcon>
            </th>
            <th pSortableColumn="code">Code
              <p-sortIcon field="code"></p-sortIcon>
            </th>
            <th>Action</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData of currency>
          <tr>
            <td><span class="p-column-title">City Name : </span>{{ rowData.name }}</td>
            <td><span class="p-column-title">Code : </span>{{ rowData.code }}</td>
            <td>
              <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-primary m-2"
                (click)="CreateCity(rowData.id)"></button>
              <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger m-2"
                (click)="Delete(rowData.id, rowData.name)"></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <p-dialog [closable]="false" [breakpoints]="{ '960px': '75vw', '640px': '100vw' }" [modal]="true" [draggable]="false" [resizable]="false"
  [(visible)]="CityDialog" [style]="{ width: '50%' }" *ngIf="CityDialog">
  <p-header>
    {{CityData?.id ? 'Edit City - ': 'Add New City' }} {{CityData?.name}}
  </p-header>
  <div class="row" [formGroup]="CityForm">
    <div class="col-sm-6 form-group mb-3">
      <label>State <span style="color: red"> * </span></label>
        <p-dropdown appendTo="body"formControlName="state_id" 
        optionLabel="name" [(ngModel)]="CityData.state_id" [options]="StateList" optionValue="id"  [filter]="true" [virtualScroll]="true"
       placeholder="Select State" ></p-dropdown>
       <app-validation propertyName="state_id" [MessageArray]="CityValidationMessage"
       [FormGroupName]="CityForm"></app-validation>
    </div>
    <div class="col-sm-6 form-group mb-3">
      <label>Name<span style="color: red"> * </span></label>
      <input type="text" class="form-control" formControlName="name" placeholder="Enter Name"
        [(ngModel)]="CityData.name" />
        <app-validation propertyName="name" [MessageArray]="CityValidationMessage"
        [FormGroupName]="CityForm"></app-validation>
     
    </div>
    <div class="col-sm-6 form-group mb-3">
      <label>Code <span style="color: red"> * </span></label>
      <input type="text" class="form-control" formControlName="code" placeholder="Enter Code"
        [(ngModel)]="CityData.code" />
        <app-validation propertyName="code" [MessageArray]="CityValidationMessage"
        [FormGroupName]="CityForm"></app-validation>
     
    </div>
  
  </div>
  <p-footer>
    <div style="text-align: right" class="mt-3">
      <button pButton pRipple icon="pi pi-times-circle" label="Cancel" class="p-button-secondary me-3 mb-3"
        (click)="CloseDialouge()"></button>
      <button pButton pRipple icon="pi pi-check-circle" label="Save" class="p-button-success me-3 mb-3"
        *ngIf="!CityData.id" (click)="Save()"></button>
      <button pButton pRipple icon="pi pi-check-circle" label="Update" class="p-button-success me-3 mb-3"
        *ngIf="CityData.id" (click)="Save()"></button>
    </div>
  </p-footer>
</p-dialog>
<p-confirmDialog header="Confirmation" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text"></p-confirmDialog>