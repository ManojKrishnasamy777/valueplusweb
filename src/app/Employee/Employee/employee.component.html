<div class="card">
    <div class="card-body">
        <div class="mb-4">
            <h1 *ngIf="EmployeeData.id">
                <i class="fas fa-chevron-left align-self-center"></i>Edit Employee - {{EmployeeData?.first_name}}
                {{EmployeeData?.last_name}}
            </h1>
            <h1 *ngIf="EmployeeData.id == 0">
                <i class="fas fa-chevron-left align-self-center"></i>
                Add New Employee
            </h1>
        </div>

        <p-tabView>
            <p-tabPanel header="InFo">
                <div class="row" [formGroup]="EmployeeForm">
                    <div class="mb-3" style="text-align: right;">
                        <button routerLink="/EmployeeList" pButton pRipple icon="pi pi-times-circle" label="Cancel"
                            (click)="CloseDialouge()" class="p-button-secondary me-3 mb-3"></button>
                        <button pButton pRipple icon="pi pi-check-circle" label="Save" (click)="Save()"
                            *ngIf="EmployeeData.id == 0" class="p-button-success me-3 mb-3"></button>
                        <button pButton pRipple icon="pi pi-check-circle" label="Update"
                            class="p-button-success me-3 mb-3" (click)="Save()" *ngIf="EmployeeData.id"></button>

                    </div>
                    <div class="col-sm-4 form-group mb-3">
                        <label>Department<span style="color: red;"> * </span></label>
                        <p-dropdown appendTo="body" formControlName="department" optionLabel="name" optionValue="id"
                            [options]="DepartmentList" placeholder="Select department"
                            [(ngModel)]="EmployeeData.department"></p-dropdown>
                        <app-validation propertyName="department" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-sm-4 form-group mb-3">
                        <label> First Name<span style="color: red"> * </span></label>
                        <input type="text" placeholder="Enter First Name" formControlName="first_name" class="form-control"
                        placeholder="Enter First Name" [(ngModel)]="EmployeeData.first_name" />
                        <app-validation propertyName="first_name" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-sm-4 form-group mb-3">
                        <label> Last Name</label>
                        <input type="text" placeholder="Enter Last Name" formControlName="last_name" class="form-control"
                        placeholder="Enter Last Name" [(ngModel)]="EmployeeData.last_name" />
                        <app-validation propertyName="last_name" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>

                    <div class="col-sm-4 form-group mb-3">
                        <label>Email<span style="color: red"> * </span></label>
                        <input type="email" placeholder="Enter Email" formControlName="email" class="form-control"
                            placeholder="Select Email" [(ngModel)]="EmployeeData.email" />
                        <app-validation propertyName="email" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
    
                    <div class="col-lg-4 form-group mb-3">
                        <label>Date Of Joining <span style="color: red"> * </span></label>
                        <p-calendar inputId="basic" formControlName="date_of_joining"
                            [(ngModel)]="EmployeeData.date_of_joining" dateFormat="dd-M-yy"
                            placeholder="Select Date of Joining"></p-calendar>
                        <app-validation propertyName="date_of_joining" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-lg-4 form-group mb-3">
                        <label>Year Of Experience </label>
                        <input type="text" class="form-control" placeholder="Enter Year Of Experience"
                            formControlName="year_of_experiance" [(ngModel)]="EmployeeData.year_of_experiance" />
                        <app-validation propertyName="year_of_experiance" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-lg-4 form-group mb-3">
                        <label>Date Of Birth<span style="color: red"> * </span> </label>
                        <p-calendar inputId="basic" formControlName="date_of_birth" dateFormat="dd-M-yy"
                            placeholder="Select Date Of Birth" [(ngModel)]="EmployeeData.date_of_birth"></p-calendar>
                        <app-validation propertyName="date_of_birth" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-sm-4 form-group mb-3">
                        <label>Address<span style="color: red"> * </span></label>
                        <input type="text" class="form-control" placeholder="Enter Address" formControlName="address"
                            [(ngModel)]="EmployeeData.address" />
                        <app-validation propertyName="address" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-sm-4 form-group mb-3">
                        <label>Country<span style="color: red;"> * </span></label>
                        <p-dropdown appendTo="body" formControlName="country_id" optionLabel="name" optionValue="id"
                            [options]="CountryList" (onChange)="GetStateListByCountryId($event.value)"
                            placeholder="Select Country" [(ngModel)]="EmployeeData.country_id"></p-dropdown>
                        <app-validation propertyName="country_id" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-sm-4 form-group mb-3">
                        <label>State/Tertiary<span style="color: red;"> * </span></label>
                        <p-dropdown appendTo="body" formControlName="state_id" optionLabel="name" optionValue="id"
                            [options]="StateList" (onChange)="GetCityListByStateId($event.value)"
                            placeholder="Select State/Tertiary" [(ngModel)]="EmployeeData.state_id"></p-dropdown>
                        <app-validation propertyName="state_id" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                    <div class="col-sm-4 form-group mb-3">
                        <label>City<span style="color: red;"> * </span></label>
                        <p-dropdown appendTo="body" formControlName="city_id" optionLabel="name" optionValue="id"
                            [options]="CityList" placeholder="Select City"
                            [(ngModel)]="EmployeeData.city_id"></p-dropdown>
                        <app-validation propertyName="city_id" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>

                    <div class="col-sm-4 form-group mb-3">
                        <label>Zipcode<span style="color: red"> * </span></label>
                        <input type="text" class="form-control" placeholder="Enter Zipcode" formControlName="zip_code"
                            [(ngModel)]="EmployeeData.zip_code" />
                        <app-validation propertyName="zip_code" [MessageArray]="EmployeeValidationMessages"
                            [FormGroupName]="EmployeeForm"></app-validation>
                    </div>
                </div>
            </p-tabPanel>



            <p-tabPanel header="Qualification" *ngIf="EmployeeData.id">
                <div class="mb-3" style="text-align: right">
                    <button pButton pRipple icon="pi pi-plus-circle" label="Add New Qualification"
                        class="btn btn-primary" (click)="CreateEmployee(0)"></button>
                </div>
                <p-table responsive="true" #dt [value]="EmployeeQualificationList"
                    [globalFilterFields]="['degree','specialization']"
                    sortMode="multiple"
                    [multiSortMeta]="[{ field: 'qualification_id', order: 1 },{ field: 'specialization', order: 1 },{ field: 'year_of_completion', order: 1 }]"
                    [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                    [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]"
                    styleClass="p-datatable-striped">
                    <ng-template pTemplate="caption">
                        <div class="d-flex flex-row flex-wrap justify-content-between align-items-center py-2">
                            <span> List of Qualification</span>
                            <span class="p-input-icon-left">
                                <i class="pi pi-search"></i>
                                <input pInputText type="text" placeholder="Search"
                                    (input)="dt.filterGlobal($event.target.value, 'contains')" />
                            </span>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th pSortableColumn="degree">
                                Degree
                                <p-sortIcon field="degree"></p-sortIcon>
                            </th>
                            <th pSortableColumn="specialization">
                                Specialization
                                <p-sortIcon field="specialization"></p-sortIcon>
                            </th>
                            <th>
                                Action
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData>
                        <tr>
                            <td>
                                <span class="p-column-title">Degree : </span>{{rowData.qualification.degree}}
                            </td>
                            <td>
                                <span class="p-column-title">Specialization : </span>{{rowData.qualification.specialization}}
                            </td>
                            <td>
                                <button pButton pRipple icon="pi pi-pencil"
                                    class="p-button-rounded p-button-primary m-2"
                                    (click)="CreateEmployee(rowData.id)"></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-tabPanel>
        </p-tabView>
    </div>
    
</div>


<p-dialog [closable]="false" [breakpoints]="{ '960px': '75vw', '640px': '100vw' }" [modal]="true" [draggable]="false"
    [resizable]="false" [(visible)]="EmployeelDialog" [style]="{ width: '50%' }" *ngIf="EmployeelDialog">
    <p-header>
        {{EmployeeData?.id ? 'Edit Qualification - ': 'Add New Qualification' }} {{EmployeeData?.name}}
    </p-header>
    <div class="row"[formGroup]="EmployeeQualificationForm">
            <div class="col-6 form-group mb-3">
                <label> Qualification<span style="color: red"> * </span></label>
                <p-dropdown appendTo="body" formControlName="qualification_id" optionLabel="label" optionValue="id"
                    [options]="QualificationList" placeholder="Select Degree"
                    [(ngModel)]="EmployeeQualificationData.qualification_id"
                   ></p-dropdown>
                <app-validation propertyName="qualification_id" [MessageArray]="QualificationValidationMessages"
                    [FormGroupName]="EmployeeQualificationForm"></app-validation>
            </div>

            <!-- <div class="col-6 form-group mb-3">
                <label>Specialization<span style="color: red"> * </span></label>
                <p-dropdown appendTo="body" formControlName="specification" optionLabel="specialization"
                    optionValue="id" [options]="SpecilizationList" placeholder="Select Specialization"
                    [(ngModel)]="SpecificationId"></p-dropdown>
                <app-validation propertyName="specification" [MessageArray]="QualificationValidationMessages"
                    [FormGroupName]="EmployeeQualificationForm"></app-validation>
            </div> -->

            <div class="col-6 form-group mb-3">
                <label>Year of completion </label>
                <p-calendar formControlName="year_of_completion" appendTo="body" placeholder="Select Year of Completion"
                    [(ngModel)]="EmployeeQualificationData.year_of_completion" view="year" dateFormat="yy"
                    inputId="yearpicker"></p-calendar>
                <app-validation propertyName="year_of_completion" [MessageArray]="QualificationValidationMessages"
                    [FormGroupName]="EmployeeQualificationForm"></app-validation>
            </div>

            <div class="col-lg-6">
                <label>Certification Name </label>
                <input type="text" class="form-control" formControlName="certificate_name"
                    placeholder="Enter Certification Name" [(ngModel)]="EmployeeQualificationData.certificate_name" />
                <app-validation propertyName="certificate_name" [MessageArray]="EmployeeValidationMessages"
                    [FormGroupName]="EmployeeForm"></app-validation>
            </div>

            <div class="col-lg-6">
                <label>Duration </label>
                <input type="text" numeric class="form-control" formControlName="duration" placeholder="Enter Duration"
                    [(ngModel)]="EmployeeQualificationData.duration" />
                <app-validation propertyName="duration" [MessageArray]="EmployeeValidationMessages"
                    [FormGroupName]="EmployeeForm"></app-validation>
            </div>

        </div>

        <p-footer>
            <div style="text-align: right" class="mt-3">
                <button pButton pRipple icon="pi pi-times-circle" label="Cancel" class="p-button-secondary me-3 mb-3"
                    (click)="CloseDialouge()"></button>
                <button pButton pRipple icon="pi pi-check-circle" label="Save" class="p-button-success me-3 mb-3"
                *ngIf="EmployeeData.id" (click)="SaveEmployeeQualification()"   ></button>
                <button pButton pRipple icon="pi pi-check-circle" label="Update" class="p-button-success me-3 mb-3"
                *ngIf="!EmployeeData.id" (click)="SaveEmployeeQualification()"   ></button>
            </div>
        </p-footer>
</p-dialog>























<p-confirmDialog header="Confirmation" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text"></p-confirmDialog>