<div class="card">
  <div class="card-body">
    <div>
      <h1>State List</h1>
    </div>
    <div class="mb-3" style="text-align: right">
      <button pButton pRipple icon="pi pi-plus-circle" label="Add New State" class="btn btn-primary"
        (click)="CreateState(0)"></button>
    </div>
    <p-table responsive="true" #dt [globalFilterFields]="['name', 'code']" sortMode="multiple"
      [multiSortMeta]="[{ field: 'name', order: 1 }, { field: 'code', order: 1 },]" [value]="stateList"
      [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [rows]="10"
      [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" styleClass="p-datatable-striped">
      <ng-template pTemplate="caption">
        <div class="d-flex flex-row flex-wrap justify-content-between align-items-center py-2">
          <span> List of State</span>
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input pInputText type="text" placeholder="Search"
              (input)="dt.filterGlobal($event.target.value, 'contains')" />
          </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th pSortableColumn="name">Country
            <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="name">Name
            <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="code">Code
            <p-sortIcon field="code"></p-sortIcon>
          </th>
          <th>Action</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData>
        <tr>
          <td><span class="p-column-title">State Name : </span>{{ rowData.country.name }}</td>
          <td><span class="p-column-title">State Name : </span>{{ rowData.name }}</td>
          <td><span class="p-column-title">Code : </span>{{ rowData.code }}</td>
          <td>
            <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-primary m-2"
              (click)="CreateState(rowData.id)"></button>
            <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger m-2"
              (click)="DeleteState(rowData.id, rowData.name)"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
<p-dialog [closable]="false" [breakpoints]="{ '960px': '75vw', '640px': '100vw' }" [modal]="true" [draggable]="false"
  [resizable]="false" [(visible)]="StateDialog" [style]="{ width: '50%' }" *ngIf="StateDialog">
  <p-header>
    {{StateData.id ? 'Edit State - ': 'Add New State' }} {{StateData.name}}
  </p-header>
  <div class="row" [formGroup]="StateForm">
    <div class="col-sm-6 form-group mb-3">
      <label>Country<span style="color: red"> * </span></label>
      <p-dropdown appendTo="body" formControlName="country_id" optionLabel="name" [(ngModel)]="StateData.country_id"
        [options]="CountryList" optionValue="id" [filter]="true" [virtualScroll]="true"
        placeholder="Select Country"></p-dropdown>
      <app-validation propertyName="country_id" [MessageArray]="StateValidationMessage"
        [FormGroupName]="StateForm"></app-validation>
    </div>
    <div class="col-sm-4 form-group mb-3">
      <label>Name<span style="color: red"> * </span></label>
      <input type="text" class="form-control" formControlName="name" placeholder="Enter Name"
        [(ngModel)]="StateData.name" />
      <app-validation propertyName="name" [MessageArray]="StateValidationMessage"
        [FormGroupName]="StateForm"></app-validation>
    </div>
    <div class="col-sm-4 form-group mb-3">
      <label>Code <span style="color: red"> * </span></label>
      <input type="text" class="form-control" formControlName="code" placeholder="Enter Code"
        [(ngModel)]="StateData.code" />
      <app-validation propertyName="code" [MessageArray]="StateValidationMessage"
        [FormGroupName]="StateForm"></app-validation>
    </div>
  </div>
  <p-footer>
    <div style="text-align: right" class="mt-3">
      <button pButton pRipple icon="pi pi-times-circle" label="Cancel" class="p-button-secondary me-3 mb-3"
        (click)="CloseDialouge()"></button>
      <button pButton pRipple icon="pi pi-check-circle" label="Save" class="p-button-success me-3 mb-3" (click)="Save()"
        *ngIf="!StateData.id"></button>
      <button pButton pRipple icon="pi pi-check-circle" label="Update" class="p-button-success me-3 mb-3"
        (click)="Save()" *ngIf="StateData.id"></button>
    </div>
  </p-footer>
</p-dialog>


<p-confirmDialog header="Confirmation" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text"></p-confirmDialog>